{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "When clicking ‘Test workflow’": {
      "main": [
        [
          {
            "node": "search_campaigns_bms",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "search_campaigns_bms": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me": {
      "main": [
        [
          {
            "node": "verificacao",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "verificacao": {
      "main": [
        [
          {
            "node": "updateLaunchTag",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "updateLaunchTag": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "search_campaigns_bms",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-08-24T21:54:17.112Z",
  "id": "I5MydCnDEyimd9t3",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "LC0005 | Checklist | Atualiza TAG em campaings_bms",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -592,
        352
      ],
      "id": "402b4052-d8b6-4248-b90b-ba3ffad4d263",
      "name": "When clicking ‘Test workflow’"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT * FROM campaigns_bms \nWHERE launch_tag IS NULL\n-- WHERE launch_tag = \"\"\nORDER BY data DESC\nLIMIT 50;\n",
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.4,
      "position": [
        -368,
        240
      ],
      "id": "774c34e2-e946-49d6-8cb5-512459dde258",
      "name": "search_campaigns_bms",
      "credentials": {
        "mySql": {
          "id": "SLbk0R6796E4DmlD",
          "name": "MySQL infoproduct"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -176,
        240
      ],
      "id": "ec618b8e-9721-49c7-9538-8af3a5569658",
      "name": "Loop Over Items"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me",
      "typeVersion": 1,
      "position": [
        64,
        256
      ],
      "id": "ac5aa2aa-e623-4722-bdea-6c60369a567e"
    },
    {
      "parameters": {
        "jsCode": "const campanha = $node['Replace Me'].json['Campanha'];\n\nconst termos = [\n  { termo: 'COMPRA', retorno: '[COMPRA]' },\n  { termo: 'ENGAGAMENTO', retorno: '[ENGAJAMENTO]' },\n  { termo: '[DS0425]', retorno: '[DS0425]' },\n  { termo: 'IMP0525', retorno: 'IMP0525' },\n  { termo: 'HUB0725', retorno: 'HUB0725' },\n];\n\nlet resultado = '';\nlet menorIndice = Infinity;\n\nfor (const item of termos) {\n  const indice = campanha.indexOf(item.termo);\n  if (indice !== -1 && indice < menorIndice) {\n    menorIndice = indice;\n    resultado = item.retorno;\n  }\n}\n\nreturn [\n  {\n    json: {\n      Campanha: campanha,\n      Resultado: resultado\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        240,
        256
      ],
      "id": "12029afe-7f68-45d8-881d-870c38056e40",
      "name": "verificacao"
    },
    {
      "parameters": {
        "operation": "update",
        "table": {
          "__rl": true,
          "value": "campaigns_bms",
          "mode": "list",
          "cachedResultName": "campaigns_bms"
        },
        "dataMode": "defineBelow",
        "columnToMatchOn": "id_data",
        "valueToMatchOn": "={{ $('Replace Me').item.json.id_data }}",
        "valuesToSend": {
          "values": [
            {
              "column": "launch_tag",
              "value": "={{ $json.Resultado || null }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.4,
      "position": [
        432,
        256
      ],
      "id": "83d5874c-cb58-435b-ad40-22f959343e1c",
      "name": "updateLaunchTag",
      "credentials": {
        "mySql": {
          "id": "6cR89c3DkwiktSiW",
          "name": "MySQL Vendas"
        }
      }
    },
    {
      "parameters": {
        "content": "## Atualização de Tags em campaigns_bms",
        "height": 80,
        "width": 640,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -592,
        -160
      ],
      "id": "a49404a2-9856-4a37-88eb-3f2993befc12",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "##### Match de palavras chaves para as tags",
        "height": 260,
        "width": 150,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        208,
        160
      ],
      "id": "50e2cc20-2383-470e-942f-0d4e35b383dd",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 1
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -592,
        128
      ],
      "id": "585ae083-d3f7-419c-ae87-5b7e402f9b3e",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "content": "## Verificar formato dos textos prensetes nas campanhas, para ajustar o termo dentro do code \"verificacao\"",
        "height": 288
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        176,
        -160
      ],
      "id": "3055384d-7534-4de4-9419-c1d9e9603497",
      "name": "Sticky Note2"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-08-24T21:54:17.112Z",
      "createdAt": "2025-08-24T21:54:17.112Z",
      "role": "workflow:owner",
      "workflowId": "I5MydCnDEyimd9t3",
      "projectId": "VuiAAhWq61ItL83O"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2025-08-24T22:01:33.018Z",
      "createdAt": "2025-08-24T22:01:33.018Z",
      "id": "d1w1GBePKkI4qzBH",
      "name": "Pendente"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-08-24T22:05:33.845Z",
  "versionId": "279b528a-da47-4787-9795-9826bfbab6c0"
}